<div class="dialog-container">
  <div class="dialog-header">
    <h2 mat-dialog-title>{{ esEdicion ? 'Editar Curso' : 'Nuevo Curso' }}</h2>
    <button mat-icon-button (click)="cancelar()" class="close-button">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <mat-dialog-content>
    <form [formGroup]="cursoForm" class="curso-form">
      <div class="form-row">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Título</mat-label>
          <input matInput formControlName="titulo" placeholder="Ingrese el título del curso">
          <mat-error *ngIf="cursoForm.get('titulo')?.hasError('required')">
            {{ getErrorMessage('titulo') }}
          </mat-error>
          <mat-error *ngIf="cursoForm.get('titulo')?.hasError('minlength')">
            {{ getErrorMessage('titulo') }}
          </mat-error>
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Descripción</mat-label>
          <textarea matInput formControlName="descripcion" rows="3" placeholder="Ingrese una descripción del curso"></textarea>
          <mat-error *ngIf="cursoForm.get('descripcion')?.hasError('required')">
            {{ getErrorMessage('descripcion') }}
          </mat-error>
          <mat-error *ngIf="cursoForm.get('descripcion')?.hasError('minlength')">
            {{ getErrorMessage('descripcion') }}
          </mat-error>
        </mat-form-field>
      </div>

      <div class="form-row two-columns">
        <mat-form-field appearance="outline">
          <mat-label>Categoría</mat-label>
          <mat-select formControlName="categoria">
            <mat-option *ngFor="let cat of categorias" [value]="cat">{{ cat }}</mat-option>
          </mat-select>
          <mat-error *ngIf="cursoForm.get('categoria')?.hasError('required')">
            {{ getErrorMessage('categoria') }}
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Nivel</mat-label>
          <mat-select formControlName="nivel">
            <mat-option *ngFor="let nivel of niveles" [value]="nivel">{{ nivel }}</mat-option>
          </mat-select>
          <mat-error *ngIf="cursoForm.get('nivel')?.hasError('required')">
            {{ getErrorMessage('nivel') }}
          </mat-error>
        </mat-form-field>
      </div>

      <div class="form-row two-columns">
        <mat-form-field appearance="outline">
          <mat-label>Duración</mat-label>
          <input matInput formControlName="duracion" placeholder="Ej: 40 horas">
          <mat-error *ngIf="cursoForm.get('duracion')?.hasError('required')">
            {{ getErrorMessage('duracion') }}
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Instructor</mat-label>
          <input matInput formControlName="instructor" placeholder="Nombre del instructor">
          <mat-error *ngIf="cursoForm.get('instructor')?.hasError('required')">
            {{ getErrorMessage('instructor') }}
          </mat-error>
        </mat-form-field>
      </div>

      <div class="form-row two-columns">
        <mat-form-field appearance="outline">
          <mat-label>Fecha de Inicio</mat-label>
          <input matInput type="date" formControlName="fecha_inicio">
          <mat-error *ngIf="cursoForm.get('fecha_inicio')?.hasError('required')">
            {{ getErrorMessage('fecha_inicio') }}
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Precio</mat-label>
          <input matInput type="number" formControlName="precio" placeholder="0.00" min="0" step="0.01">
          <span matPrefix>S/ &nbsp;</span>
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>URL de Imagen</mat-label>
          <input matInput formControlName="imagen" placeholder="https://ejemplo.com/imagen.jpg">
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-checkbox formControlName="certificado">Incluye certificado</mat-checkbox>
        <mat-checkbox formControlName="estado">Curso activo</mat-checkbox>
      </div>
    </form>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-button type="button" (click)="cancelar()">Cancelar</button>
    <button mat-raised-button color="primary" type="button" (click)="guardar()" [disabled]="cargando || cursoForm.invalid">
      <mat-icon>{{ esEdicion ? 'save' : 'add' }}</mat-icon>
      {{ esEdicion ? 'Actualizar' : 'Crear' }} Curso
    </button>
  </mat-dialog-actions>
</div>

